# 虚拟麦协议草案（v0）

## 目标

定义用户态服务与驱动态虚拟麦模块之间的最小控制/数据协议。

## 控制面（Control Plane）

- `IOCTL_VM_GET_STATUS`：读取驱动态状态
- `IOCTL_VM_SET_GATE`：设置门控开关（开麦/闭麦）
- `IOCTL_VM_SET_FORMAT`：设置采样率/声道/位深

## 数据面（Data Plane）

- 用户态将 PCM 帧写入共享环形缓冲区
- 驱动态按 WASAPI 拉取节奏读取数据
- 门控关闭时输出静音帧

## 状态码约定

- `0x0000`：成功
- `0x1001`：驱动未就绪
- `0x1002`：格式不匹配
- `0x1003`：缓冲欠载
- `0x1004`：缓冲溢出

## 后续任务

1. 定义协议头（二进制结构体）
2. 定义共享内存布局与版本字段
3. 建立用户态 Rust FFI 封装层
