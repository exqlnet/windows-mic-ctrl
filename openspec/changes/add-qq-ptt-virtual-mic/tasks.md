# 任务拆解：add-qq-ptt-virtual-mic

## 1. 工程脚手架

- 任务目标：完成 Tauri + React + TS 基础工程并可启动。
- 影响范围：`package.json`、`src/`、`src-tauri/`
- 实施要点：建立依赖、配置、基础窗口。
- 验收标准：`npm run build` 与 `cargo check` 可执行。
- 验证方法：执行 `npm run typecheck`、`cargo check`。
- 回滚方式：还原初始化提交。

## 2. 音频设备与配置

- 任务目标：可枚举输入/输出设备并持久化路由配置。
- 影响范围：`src-tauri/src/audio/*`、`src-tauri/src/config.rs`
- 实施要点：抽象设备 ID，支持虚拟设备候选标记。
- 验收标准：前端可拉取设备列表并保存。
- 验证方法：命令调用与单元测试。
- 回滚方式：移除新增配置字段。

## 3. 音频桥接引擎

- 任务目标：实现门控桥接（开麦透传/闭麦静音）。
- 影响范围：`src-tauri/src/audio.rs`、`src-tauri/src/gate.rs`
- 实施要点：环形缓冲、门控状态机、错误统计。
- 验收标准：引擎可启动/停止并更新运行状态。
- 验证方法：Rust 单元测试。
- 回滚方式：禁用引擎启动入口。

## 4. 快捷键与托盘

- 任务目标：支持全局快捷键控制麦克风并支持托盘菜单。
- 影响范围：`src-tauri/src/hotkey.rs`、`src-tauri/src/tray.rs`
- 实施要点：按下/释放事件映射与状态同步。
- 验收标准：托盘菜单与快捷键能切换门控状态。
- 验证方法：手动验证 + 命令测试。
- 回滚方式：关闭快捷键注册与托盘逻辑。

## 5. 前端单页 UI

- 任务目标：实现简洁主页面、设备配置、模式配置、状态展示。
- 影响范围：`src/App.tsx`、`src/components/**`
- 实施要点：shadcn 风格组件、状态轮询、引导提示。
- 验收标准：能完成完整配置流程。
- 验证方法：`npm run build` 与手动验证。
- 回滚方式：保留只读状态页。

## 6. 文档与发布说明

- 任务目标：补齐安装说明、QQ 配置指引、故障排查。
- 影响范围：`README.md`
- 实施要点：明确虚拟声卡依赖与常见问题。
- 验收标准：新用户可按文档完成首次配置。
- 验证方法：按文档走查。
- 回滚方式：恢复前版文档。
